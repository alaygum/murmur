<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ú—É—Ä–º—É—Ä</title>
  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#1b0f2a;
      --card:#0f1733cc;
      --text:#f6f7ff;
      --muted:#c9cbe6;
      --yes:#ff4fd8;
      --yes2:#ffb84f;
      --shadow: 0 12px 40px rgba(0,0,0,.45);
      --radius: 22px;

      --nyW: 210px;
      --nyH: 90px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: radial-gradient(1200px 700px at 20% 10%, #2c1b53 0%, transparent 55%),
                  radial-gradient(900px 600px at 90% 80%, #1a5a4d 0%, transparent 55%),
                  linear-gradient(160deg, var(--bg1), var(--bg2));
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      overflow:hidden;
    }

    .card{
      width:min(720px, 92vw);
      background:var(--card);
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      padding:22px 18px;
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
      position:relative;
    }

    h1{
      margin:0;
      font-size: clamp(22px, 3.2vw, 34px);
      letter-spacing: .2px;
      text-align:center;
      line-height:1.15;
    }

    .gifWrap{
      display:flex;
      align-items:center;
      justify-content:center;
      margin: 18px 0 18px 0;
    }

    .gifWrap img{
      max-width:min(520px, 86vw);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      background: rgba(255,255,255,.03);
    }

    .stage{
      width:min(520px, 86vw);
      height: 120px;
      margin: 0 auto;
      position:relative;
      user-select:none;
      touch-action: manipulation;
    }

    button{
      border:0;
      border-radius: 999px;
      padding: 14px 22px;
      font-size: 18px;
      font-weight: 750;
      cursor:pointer;
      transition: transform .15s ease, filter .15s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      position:absolute;
      top: 50%;
      transform: translateY(-50%);
      white-space:nowrap;
    }

    .yesShell{
      position:absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 22px 28px;
      border-radius: 999px;
      isolation:isolate;
    }

    .halo{
      position:absolute;
      inset: 8px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 60%),
                  radial-gradient(circle at 70% 70%, rgba(255,79,216,.45), transparent 58%);
      filter: blur(10px);
      opacity:.55;
      z-index:-1;
      animation: glow 2.3s ease-in-out infinite;
    }

    @keyframes glow{
      0%{ opacity:.45; transform: scale(1.00); }
      50%{ opacity:.70; transform: scale(1.05); }
      100%{ opacity:.45; transform: scale(1.00); }
    }

    .yesBtn{
      position:relative;
      top:auto;
      transform:none;
      background: linear-gradient(135deg, var(--yes), var(--yes2));
      color:#17061c;
      text-shadow: 0 1px 0 rgba(255,255,255,.25);
      filter: saturate(1.1);
      animation: breathe 1.9s ease-in-out infinite;
    }

    @keyframes breathe{
      0%{ transform: scale(1.00); }
      50%{ transform: scale(1.04); }
      100%{ transform: scale(1.00); }
    }

    .yesBtn:hover{
      transform: scale(1.08);
      filter: brightness(1.05) saturate(1.2);
    }

    .noBtn{
      right: 0;
      background: rgba(255,255,255,.10);
      color: #e8ebff;
      border:1px solid rgba(255,255,255,.18);
    }

    .nyan{
      position:absolute;
      width: 44px;
      height: 44px;
      pointer-events:none;
      z-index:3;
      left:0;
      top:0;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
      animation: nyanLoop 2.8s linear infinite;
    }
    .nyan img{
      width:100%;
      height:100%;
      object-fit:contain;
    }
    @keyframes nyanLoop{
      0%   { transform: translate(0px, 0px); }
      25%  { transform: translate(var(--nyW), 0px); }
      50%  { transform: translate(var(--nyW), var(--nyH)); }
      75%  { transform: translate(0px, var(--nyH)); }
      100% { transform: translate(0px, 0px); }
    }

    .hidden{ display:none; }

    .puff{
      position:fixed;
      font-size: 20px;
      pointer-events:none;
      z-index: 10;
      transform: translate(-50%, -50%);
      animation: puffOut .55s ease forwards;
      filter: drop-shadow(0 8px 14px rgba(0,0,0,.35));
    }
    @keyframes puffOut{
      0%{ opacity:0; transform: translate(-50%, -50%) scale(.7); }
      15%{ opacity:1; transform: translate(-50%, -50%) scale(1); }
      100%{ opacity:0; transform: translate(-50%, -68%) scale(1.25); }
    }

    .confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index: 20;
      overflow:hidden;
    }
    .confetti span{
      position:absolute;
      width: 10px;
      height: 16px;
      border-radius: 4px;
      opacity:.95;
      transform: translateY(-30px) rotate(0deg);
      animation: fall 1.2s ease-in forwards;
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(360deg); opacity:0.85; }
    }

    @media (prefers-reduced-motion: reduce){
      .yesBtn{ animation:none; }
      .halo{ animation:none; }
      .nyan{ animation:none; }
      button{ transition:none; }
    }
  </style>
</head>
<body>
  <div class="card">
    <div id="viewAsk">
      <h1>–¢—ã –±—É–¥–µ—à—å –º–æ–∏–º –ú—É—Ä–º—É—Ä–æ–º?</h1>

      <div class="gifWrap">
        <img id="mainGif" src="ask.gif" alt="–ö–æ—Ç—ë–Ω–æ–∫" loading="eager" />
      </div>

      <div class="stage" id="stage">
        <div class="yesShell" id="yesShell">
          <div class="halo"></div>
          <button class="yesBtn" id="yesBtn">–î–∞ üíò</button>
          <div class="nyan" id="nyan">
            <img src="nyan.gif" alt="Nyan Cat" />
          </div>
        </div>

        <button class="noBtn" id="noBtn">–ù–µ—Ç</button>
      </div>
    </div>

    <div id="viewYes" class="hidden">
      <h1>–£—Ä–∞!<br>–ú–æ–π –ª—é–±–∏–º—ã–π –ª–∞—Å–∫–æ–≤—ã–π –ú—É—Ä–º—É—Ä!</h1>

      <div class="gifWrap">
        <img id="celebrateGif" src="celebrate.gif" alt="–ü—Ä–∞–∑–¥–Ω—É–µ–º" loading="eager" />
      </div>
    </div>
  </div>

  <div class="confetti hidden" id="confetti"></div>

  <script>
    const ASSETS = {
      ask: "ask.gif",
      celebrate: "celebrate.gif",
      nyan: "nyan.gif"
    };

    const viewAsk = document.getElementById("viewAsk");
    const viewYes = document.getElementById("viewYes");

    const mainGif = document.getElementById("mainGif");
    const celebrateGif = document.getElementById("celebrateGif");

    const stage = document.getElementById("stage");
    const yesShell = document.getElementById("yesShell");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const nyan = document.getElementById("nyan");
    const confetti = document.getElementById("confetti");

    [ASSETS.ask, ASSETS.celebrate, ASSETS.nyan].forEach(src => {
      const img = new Image();
      img.src = src;
    });
    mainGif.src = ASSETS.ask;
    celebrateGif.src = ASSETS.celebrate;
    nyan.querySelector("img").src = ASSETS.nyan;

    function updateNyanPath(){
      const rect = yesShell.getBoundingClientRect();
      const pad = 34;
      const w = Math.max(140, rect.width - pad);
      const h = Math.max(70, rect.height - pad);
      document.documentElement.style.setProperty("--nyW", `${w}px`);
      document.documentElement.style.setProperty("--nyH", `${h}px`);
    }
    window.addEventListener("resize", updateNyanPath, { passive: true });
    updateNyanPath();

    const MIN_DIST = 110;
    const STEP = 70;
    const MARGIN = 10;
    let rafId = null;

    function spawnPuff(x, y){
      const el = document.createElement("div");
      el.className = "puff";
      el.textContent = "üí®";
      el.style.left = x + "px";
      el.style.top = y + "px";
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 650);
    }

    function rectsOverlap(r1, r2){
      return !(r2.left > r1.right || r2.right < r1.left || r2.top > r1.bottom || r2.bottom < r1.top);
    }

    function getNoRect(){ return noBtn.getBoundingClientRect(); }

    function setNoPos(leftPx, topPx){
      noBtn.style.left = `${leftPx}px`;
      noBtn.style.top = `${topPx}px`;
      noBtn.style.right = "auto";
      noBtn.style.transform = "translate(-50%, -50%)";
    }

    function ensureNoHasExplicitPos(){
      const r = getNoRect();
      const sr = stage.getBoundingClientRect();
      const x = r.left - sr.left + r.width / 2;
      const y = r.top - sr.top + r.height / 2;
      setNoPos(x, y);
    }

    function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

    function moveNoAway(cursorX, cursorY){
      const sr = stage.getBoundingClientRect();
      const r = getNoRect();
      const yesR = yesShell.getBoundingClientRect();

      const noCx = r.left + r.width/2;
      const noCy = r.top + r.height/2;

      const dx = noCx - cursorX;
      const dy = noCy - cursorY;
      const dist = Math.hypot(dx, dy);

      if(dist >= MIN_DIST) return;

      spawnPuff(noCx, noCy);

      let ux = dx / (dist || 1);
      let uy = dy / (dist || 1);

      if(dist === 0){
        const a = Math.random() * Math.PI * 2;
        ux = Math.cos(a);
        uy = Math.sin(a);
      }

      const jitter = () => (Math.random() - 0.5) * 18;

      let targetX = (noCx - sr.left) + ux * STEP + jitter();
      let targetY = (noCy - sr.top) + uy * STEP + jitter();

      const minX = MARGIN + r.width/2;
      const maxX = sr.width - MARGIN - r.width/2;
      const minY = MARGIN + r.height/2;
      const maxY = sr.height - MARGIN - r.height/2;

      targetX = clamp(targetX, minX, maxX);
      targetY = clamp(targetY, minY, maxY);

      const candidate = {
        left: sr.left + targetX - r.width/2,
        right: sr.left + targetX + r.width/2,
        top: sr.top + targetY - r.height/2,
        bottom: sr.top + targetY + r.height/2
      };

      if(rectsOverlap(candidate, yesR)){
        targetX = clamp(targetX + (targetX < sr.width/2 ? -STEP : STEP), minX, maxX);
        targetY = clamp(targetY + (targetY < sr.height/2 ? -STEP : STEP), minY, maxY);
      }

      setNoPos(targetX, targetY);
    }

    function onMouseMove(e){
      if(rafId) return;
      const x = e.clientX;
      const y = e.clientY;
      rafId = requestAnimationFrame(() => {
        rafId = null;
        moveNoAway(x, y);
      });
    }

    document.addEventListener("mousemove", onMouseMove, { passive: true });

    stage.addEventListener("touchstart", (e) => {
      const t = e.touches && e.touches[0];
      if(!t) return;
      moveNoAway(t.clientX, t.clientY);
    }, { passive: true });

    stage.addEventListener("touchmove", (e) => {
      const t = e.touches && e.touches[0];
      if(!t) return;
      moveNoAway(t.clientX, t.clientY);
    }, { passive: true });

    noBtn.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      const r = getNoRect();
      spawnPuff(r.left + r.width/2, r.top + r.height/2);
    });

    function launchConfetti(){
      confetti.classList.remove("hidden");
      confetti.innerHTML = "";
      const pieces = 28;

      for(let i = 0; i < pieces; i++){
        const s = document.createElement("span");
        s.style.left = (Math.random() * 100) + "vw";
        s.style.top = (-10 - Math.random() * 30) + "px";

        const w = 6 + Math.random() * 10;
        const h = 10 + Math.random() * 18;
        s.style.width = w + "px";
        s.style.height = h + "px";

        const hue = Math.floor(Math.random() * 360);
        s.style.background = `hsla(${hue}, 90%, 70%, 0.95)`;

        confetti.appendChild(s);
      }

      setTimeout(() => {
        confetti.classList.add("hidden");
        confetti.innerHTML = "";
      }, 1400);
    }

    yesBtn.addEventListener("click", () => {
      launchConfetti();
      viewAsk.classList.add("hidden");
      viewYes.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "instant" });
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏ "–ù–µ—Ç" –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ stage, –Ω–æ —Å —è–≤–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
    (function init(){
      ensureNoHasExplicitPos();
      const sr = stage.getBoundingClientRect();
      const r = getNoRect();
      const x = sr.width - (r.width/2) - 14;
      const y = sr.height / 2;
      setNoPos(x, y);
    })();
  </script>
</body>
</html>
